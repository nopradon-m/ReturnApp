# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  LineScreen:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Header_7:
          Control: CanvasComponent
          ComponentName: Header
          Properties:
            Height: =76
            Width: =1366
      - Gallery2:
          Control: Gallery@2.15.0
          Variant: BrowseLayout_Vertical_TwoTextVariant_ver5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Height: =650
            Items: |+
              =SortByColumns(
                  Filter(LineOASubmitSalesReturn, Department = divisionS.Text && EndConversation = 1),
                  "Created",
                  SortOrder.Descending
              )
            TemplateSize: =66
            Width: =1366
            Y: =117
          Children:
            - Subtitle1:
                Control: Label@2.5.1
                Properties:
                  AutoHeight: =true
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(71, 69, 64, 1)
                  DisabledColor: =RGBA(186, 186, 186, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =25
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Text: =ThisItem.displayNameL
                  VerticalAlign: =VerticalAlign.Top
                  Width: =221
                  X: =32
                  Y: =20
            - Separator3:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 0, 255, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Height: =8
                  OnSelect: =Select(Parent)
                  Width: =Parent.TemplateWidth
                  Y: =Parent.TemplateHeight - Self.Height
            - Rectangle1:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(0, 18, 107, 1)
                  Height: =Parent.TemplateHeight - Separator3.Height
                  OnSelect: =Select(Parent)
                  Visible: =ThisItem.IsSelected
                  Width: =4
            - Title1_1:
                Control: Label@2.5.1
                Properties:
                  AutoHeight: =true
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(71, 69, 64, 1)
                  DisabledColor: =RGBA(186, 186, 186, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =33
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =14
                  Text: =ThisItem.ReasonL
                  VerticalAlign: =VerticalAlign.Top
                  Width: =308
                  X: =716
                  Y: =20
            - Title1_2:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(71, 69, 64, 1)
                  DisabledColor: =RGBA(186, 186, 186, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =25
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =14
                  Text: =ThisItem.refNo
                  VerticalAlign: =VerticalAlign.Top
                  Width: =147
                  X: =535
                  Y: =20
            - Title1_3:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(71, 69, 64, 1)
                  DisabledColor: =RGBA(186, 186, 186, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =25
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =14
                  Text: =ThisItem.telCus
                  VerticalAlign: =VerticalAlign.Top
                  Width: =133
                  X: =1049
                  Y: =20
            - Button10:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =RGBA(255, 255, 255, 1)
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(56, 96, 178, 1)
                  Font: =Font.'Open Sans'
                  Height: =32
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Collect(
                        RequestTemp,
                        {
                            companyL: ThisItem.companyL,
                            displayNameL: ThisItem.displayNameL,
                            refNo: ThisItem.refNo,
                            ReasonL: ThisItem.ReasonL,
                            telCus: ThisItem.telCus,
                            uid: ThisItem.Title
                        }
                    );

                    Set(selectedRequest, First(RequestTemp));
                    Back();

                    Set(invoiceDate,Blank());

                    If(StartsWith(DataCardValue8.Text,"INV"),
                    Set(FindInvoice,'03-Find-Invoice-Date'.Run(DataCardValue8.Text));
                    If(!IsBlank(FindInvoice.invoicedate),
                    Set(invoiceDate,DateValue(FindInvoice.invoicedate)),
                    Notify("ไม่พบเลข Invoice",NotificationType.Error)),


                    false)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Select"
                  Width: =128
                  X: =1218
                  Y: =13
            - Subtitle1_1:
                Control: Label@2.5.1
                Properties:
                  AutoHeight: =true
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(71, 69, 64, 1)
                  DisabledColor: =RGBA(186, 186, 186, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =25
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Text: =ThisItem.companyL
                  VerticalAlign: =VerticalAlign.Top
                  Width: =221
                  X: =301
                  Y: =20
      - Icon7:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            Icon: =Icon.ChevronLeft
            OnSelect: =Back()
            X: =31
            Y: =6
      - Label22:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 16, 96, 1)
            Font: =Font.'Open Sans'
            Text: ="    Display Name                                     Company                                  Invoice / Ref No.             Reason                                                           Tel"
            Width: =1366
            Y: =77
